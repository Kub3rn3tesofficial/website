<a class="item" data-title="{{ .LinkTitle }}" href="{{ .RelPermalink }}"></a>
{{ template "section-tree-nav" (dict "ctx" . "section" .) }}
{{ define "section-tree-nav" }}
	{{ $pages :=  (union .section.Pages .section.Sections) }}
	{{ $.ctx.Scratch.Set "tree_pages" $pages }}
	{{ with $.ctx.Site.Params.language_alternatives }}
		{{ if ge (len .) 0 }}
		{{ $.ctx.Scratch.Set "tree_sections" (slice $pages) }}
		{{ range . }}	
			{{ with (where $.section.Translations ".Lang" . ) }}
			{{ $p := index . 0 }}
			{{ $.ctx.Scratch.Add "tree_sections" (slice (union $p.Pages $p.Sections)) }}
			{{ end }}
		{{ end }}
		{{ partial "lang/alternatives-merge" (dict "ctx" $.ctx "from" "tree_sections" "to" "tree_pages") }}
		{{ end }}
	{{ end }}
	{{ $sections := where ($.ctx.Scratch.Get "tree_pages").ByWeight ".Params.toc_hide" "!=" true }}
	{{ range $sections }}
		{{ if .IsPage }}
			{{ template "section-tree-nav-page"  (dict "ctx" $.ctx "page" .) }}
		{{ else }}
			{{ template "section-tree-nav-section" (dict "ctx" $.ctx "section" .) }}
		{{ end }}
	{{ end }}
{{ end }}
{{ define "section-tree-nav-section" }}
<div class="item" data-title="{{ .section.LinkTitle }}">
	<div class="container">
		{{ if ge (len .section.Content) 10 }}
		{{/* The section page has content, so link to it. */}}
		{{ $isForeignLanguage := (ne .section.Lang $.ctx.Lang)}}
		<a class="item" {{ if $isForeignLanguage }}target="_blank" {{ end }}data-title="{{ .section.LinkTitle }}{{ if $isForeignLanguage }} <small>({{ .section.Lang | upper }})</small>{{ end }}" href="{{ .section.RelPermalink }}"></a>
		{{ end }}
		{{ template "section-tree-nav" . }}
	</div>
</div>
{{ end }}
{{ define "section-tree-nav-page" }}
{{ $isForeignLanguage := (ne .page.Lang $.ctx.Lang)}}
<a class="item" {{ if $isForeignLanguage }}target="_blank" {{ end }}data-title="{{ .page.LinkTitle }}{{ if $isForeignLanguage }} <small>({{ .page.Lang | upper }})</small>{{ end }}" href="{{ .page.RelPermalink }}"></a>
{{ end }}